function [tot_pred] = interp_pred_fr_v2(I_cur,S_cur, prs_cur,do_all_rules)

%%%%%%%%%%%%
% adapted from pp_sp_code_results_v2.m
%Started 4/25/21 CRS
%Last Updated 4/26/21 CRS
%adapted from pp_sp_demo_vX.m version files into a single file
%Adding: 4/26/21 - (1) interpolating instead of fitting smooth funcitons to how
%values change over time (2) do a 2D rms between kathy's data and the new
%data
%Adding: For demoing different rules:
%do_PE, do_FE - partial elim, full elim for pulse-pulse block can do w/o
%part elim and full elim effects
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Values found in interp_all_fun_w_interpolator_test_v2.m
% % % cur_dir_vals = '/Users/cynthiasteinhardt/Dropbox/single-neuron-stim-model/vestibular-neuron-models/vest_model_pulsatile/simpler_format/useful_sim_data/3_axon_runs_4_12_21/axon_1_facil_Is';
% % % load(fullfile(cur_dir_vals,'interp_params_4_29_21_v2.mat'));

 [I_in_t_block,I_S_t_PS_SP, I_switch_facils, pr_bend_per_S, prt_elim_S,down_slopes,up_slopes ] = load_params;

 x_range_t_blck(1).range = [min(I_in_t_block(:,1)):.1:max(I_in_t_block(:,1))];
  x_range_t_blck(2).range = [min(I_in_t_block(:,2)):.1:max(I_in_t_block(:,2))];
  
xs_range_prt_elim(1).range = [0:.1:max(prt_elim_S(:,1))];
xs_range_prt_elim(2).range = [0:.1:max(prt_elim_S(:,2))];
xs_slope  = up_slopes(:,1:2);
y_slope = up_slopes(:,3);
x_range_up(1).range = [0:.1:max(up_slopes(:,2))]; %S before I
x_range_up(2).range = [0:.1:max(up_slopes(:,1))];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Interpolated inputs given I_cur and X_cur
%I


%f_I_switch_facil = @(S) (50- S).*(S<=13) + (37+.235*(S-13)).*((S>13)&(S<85)) + (54)*(S>=85);

% Full shift:
f_full_elim_1 = @(S) min(250,270*sigmf(S,[.24 19]));
f_full_elim_2 = @(S) max(-60,(S<=7.05).*(-5.67*S) + (S>7.05).*(-40-3.43*(S-7)));

%X-Bend!
%f_pr_bend_per_S = @(S) 2.35*S.*(S<31) + (S>=31).*(70) + (S>=55).*(1.3.*(S-55)) + (S>=85.5).*(-.84*(S-85.5));


col_opt = winter(7);

% Cannot predict outside of range of x input..
[pred_t_block] = interp_SI_funs(I_in_t_block (:,[ 2 1]),I_in_t_block (:,3),x_range_t_blck,[I_cur S_cur],0);

%S,I

[pred_up_slope] = interp_SI_funs( up_slopes(:,1:2),up_slopes(:,3),x_range_up,[S_cur I_cur],0);

[pred_down_slope] = interp_SI_funs(down_slopes(:,[4 1]),down_slopes(:,2),xs_range_prt_elim,[I_cur min(130,S_cur)],0);


%I, S
[pred_prt_elim_1] = interp_SI_funs(prt_elim_S(:,[2 1]),prt_elim_S(:,3),xs_range_prt_elim,[I_cur min(130,S_cur)],0);

%I, S
[pred_prt_elim_2] = interp_SI_funs(prt_elim_S(:,[2 1]),prt_elim_S(:,4),xs_range_prt_elim,[I_cur min(130,S_cur)],0);

%Pred facilitation scaling and slopes:
[pred_facil_slope] = interp_SI_funs(I_S_t_PS_SP(:,[2 1]),I_S_t_PS_SP(:,3),xs_range_prt_elim,[I_cur min(130,S_cur)],0);
[pred_facil_scale] = interp_SI_funs(I_S_t_PS_SP(:,[2 1]),I_S_t_PS_SP(:,4),xs_range_prt_elim,[I_cur min(130,S_cur)],0);



 Ss = [131 85.9 55.69 29.4 12.9 7.05 0];
% I_switch_facils = [30 32 35 35 35 44  44];
% pr_bend_per_S = [140 100 70 50 32 20 0];
x_range_S(1).range = [min(Ss):max(Ss)];
%Pred facil window:
[I_switch_fac] = interp_SI_funs(Ss,I_switch_facils,x_range_S,S_cur,0);
[pr_bend] = interp_SI_funs(Ss,pr_bend_per_S,x_range_S,S_cur,0);
%Pred bend location:


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

cur_m1= pred_up_slope;

prt_elims(1) = pred_prt_elim_1;
prt_elims(2) = pred_prt_elim_2;

t_block = pred_t_block;% I_in_t_block(44*(S_idx -1)+I_idx,3);%pred_t_block;

t_SP_PS = [pred_facil_slope pred_facil_scale];

[corr_ipi] = all_pp_block_calc(I_cur,prs_cur,S_cur,prt_elims,[f_full_elim_1(S_cur),f_full_elim_2(S_cur)],t_block, t_SP_PS,do_all_rules );
corr_ipi(prs_cur == 0) = 0;


% if  (I_cur >= 312)
%     corr_ipi = zeros(1,length(prs_cur));
% end
[val bend_idx] = min(abs(prs_cur - pr_bend));
% pr_bend = pr_bend_down;
before_bend = (cur_m1.*prs_cur).*(prs_cur <= pr_bend);



%Slope down check:
if I_cur >= 156%n_curs >=16
    cur_slope = pred_down_slope;
    down_slope = max(-S_cur,(cur_slope.*(prs_cur - pr_bend)));
else
    down_slope = 0;
end


%SP scales Ps down Ps blocks S but that rule can be use to make S go up
if (I_cur <=I_switch_fac)
    tot_pred =  corr_ipi;
else
    P_sub_val_by_S = corr_ipi(bend_idx);
    P_max_add = (max(min(0,-cur_m1.*prs_cur(bend_idx)),corr_ipi - P_sub_val_by_S )); %maybe also scale it
    
    tot_pred = before_bend  + P_max_add.*(prs_cur >=  pr_bend)  + max(-S_cur,(down_slope + cur_m1.*prs_cur(bend_idx))).*(prs_cur >pr_bend);  
end

end

%%

function [corr_ipi] = all_pp_block_calc(I_cur,prs,S,prt_elims_tmp,full_elim_drop,t_block,   t_SP_PS,do_all_rules )
%t_block is the calculated t_pp (or t FR = 1*PR --> PR/2)
%I_cur = all_cur(n_cur);
%%%%%% FIXES:
% Fixed merge at transition point p_prt to p_full - 4/16/21 12:42 AM


%%
%See Fit: figure(1); plot(all_cur, t_block_f_pred,'b.','markersize',10);

%%% Relating parameters to cathodic and anodic phase axon effects:
%%% Assume that cathodic phase of stimulation increases linearly with
%%% current amplitude and look at what anodic must do in comparison.

% If want to demo with only some of rules (as in paper):
do_PE = do_all_rules(1);
do_FE = do_all_rules(2);

% Keep fixed
cath_eff = (I_cur/230).^2;%(all_cur/230)*scale;
facill_eq = sigmf(I_cur,[.1 55]);
%figure(1); plot(I_cur,facill_eq)

an_eff = t_block.*cath_eff;%facill_eq;
t_block = an_eff./cath_eff;%facill_eq;
t_block= min(t_block, 200);
%an_eff_switch = 5.25;% Shift from suppressing to fully shutting down axon (keep fixed)


%%%%%%
%Facillitation
%add_wind = 3.5;%%5; %1: .2;%

corr_ipi = prs./ceil(t_block./(1e3./prs));
bend_nums = ceil(t_block./(1e3./prs));


%%%%%%%%%
%%%%%%%%%
%%%%%%%%% part elimination
if do_PE
clear perc_elim_tmp

%How many bends to do part elim at:
num_bends = max(3,ceil(t_block/(1e3./600)));
if (an_eff > 5)
    num_bends = 3;
end
%For each bend do the partial elim

for n_bend = 1:(num_bends-1)
    if n_bend == 1
        pr_full_elim = (1e3./t_block);%sim_data(1).key_pts(n_cur,(n_bend-1)*2+2+1);%%%
        t_pp_full12 = t_block;
    end
    
    if isempty(find(bend_nums == n_bend+1))
        ipi_switch = (t_block/n_bend);%(prs(min(find(bend_nums == 2)))*2);
        pr_full_elim = (1e3./ipi_switch) ;
        
    else
        ipi_switch = t_block/n_bend;%ms
        pr_full_elim = (1e3./ipi_switch);%pps
    end
    
    if n_bend == 1
        %%%part_elim_frac =  part_elim_f(I_cur);
        part_elim_frac = prt_elims_tmp(1);
    else
        %%%part_elim_frac =   part_elim_n_np1(I_cur,0.025,.175,.8,8.5,105);
        part_elim_frac = prt_elims_tmp(2);
    end
    
    pr_prt_elim = pr_full_elim -  min(.99,part_elim_frac).*(1e3./t_block);
    %sim_data(1).key_pts(n_cur,(n_bend-1)*2+2+1);
    t_pp_prt = 1e3/pr_prt_elim;
    t_pp_full = 1e3/(pr_full_elim); %ms
    
    
    scale_up = 5*(((I_cur+full_elim_drop(2))/300).^(4));%*full_elim_drop(2)));
    if ((an_eff > 5 ) & do_FE) %I = 200 for sim with no spont firing
        %Rule that does partial elimination where the tPP builds and
        %so partial elimination becomes full elimination and 2/3
        %becomes stronger
        
        if n_bend == 2
            % Full kill is like deep partial elimination:
            scale_fact = 200/full_elim_drop(1);%/max(1,S);
            perc_elim_tmp(n_bend,:) = scale_fact*((1-(((1e3./prs) - t_pp_full)/(t_pp_prt - t_pp_full))).^(3).*((t_pp_prt - 1e3./prs) >= 0));
            % perc_elim_tmp(n_bend,(max(find((1e3./prs - t_pp_full) >= 0))):end) = scale_fact;
            
            
        else
            if  (S<10)
                %                 First dip is dynamics getting trapped in a loop modeled
                %                 like this (b/c pulses get looped with selves):
                tmp_perc = ((((1e3./prs) - t_pp_full)/(t_pp_prt - t_pp_full))).*...
                    (((1e3./prs - t_pp_full) > 0) & ((t_pp_prt - 1e3./prs ) >= 0));
                perc_elim_tmp(n_bend,:) = ceil(tmp_perc*scale_up);%round(tmp_perc*scale_up);%scales up when amplitude really high
            else
                
                perc_elim_tmp(n_bend,:) = min(1,(1+scale_up)*(1 - (((1e3./prs) - t_pp_full)/(t_pp_prt - t_pp_full)))).*...
                    (((1e3./prs - t_pp_full) >= 0) & ((t_pp_prt - 1e3./prs ) >= 0));
            end
        end
        
    else
        
        perc_elim_tmp(n_bend,:) = min(1,(1+scale_up)*(1 - (((1e3./prs) - t_pp_full)/(t_pp_prt - t_pp_full)))).*...
            (((1e3./prs - t_pp_full) >= 0) & ((t_pp_prt - 1e3./prs ) >= 0));
        
    end
end
%Get part and full elim part of bend
perc_elim = sum(perc_elim_tmp,1);

if (an_eff > 5)
    corr_ipi = (prs./(min(ceil(t_pp_full12./((1e3./prs))),2) + perc_elim));%.*facill_eq;%.*(sol_temp).*(sol_temp >= .75);
    
else
    corr_ipi = (prs./(ceil(t_pp_full12./((1e3./prs))) + perc_elim));%.*facill_eq;%.*(sol_temp).*(sol_temp >= .75);
end
%Corr_ipi same as above 
end
prs_tmp = prs;
prs_tmp(prs_tmp == 0) = 1000;
IPI =1e3./prs_tmp;


if S == 0
    S_scale = 40;
    ISI = round(1e3/5);
    t_p =  S_scale*t_SP_PS(1);
    
    mod_tot = lcm(round(ISI),round(IPI));
    p_elim_s = min(1,.65+((mod_tot./IPI).*t_p)./mod_tot);
    
    p_elim_s(prs ==0) = 0;
    if (t_SP_PS(1) >= .04)
        corr_ipi2 =corr_ipi.*(p_elim_s)*t_SP_PS(2) ;
    else
        corr_ipi2 =corr_ipi.*( p_elim_s > .8).*( p_elim_s)*t_SP_PS(2) ;
    end
else
    %S_scale = 10;
    %IPI((prs==0)) = 1;
    ISI = 1e3/S;
    
    
    effect_w_prs = min(1,t_SP_PS(1).*prs);
    corr_ipi(prs ==0) = 0;
    
    S_scale = .33;
    corr_ipi2 =(corr_ipi).*t_SP_PS(2).*( effect_w_prs >.8).*(effect_w_prs) + ....
        (corr_ipi).*S_scale.*effect_w_prs.*( effect_w_prs <=.8);
end

corr_ipi = corr_ipi2;
end


function [pred_z] = interp_SI_funs(xs,y,x_range,xs_fit,plot_it)

if size(xs,1) < size(xs,2)
    xs = xs';
end
if size(y,1) < size(y,2)
    y = y';
end
if size(xs_fit,1) > size(xs_fit,2)
    xs_fit = xs_fit';
end

%Remove nans:
xs_clean = xs(find(~isnan(y)),:);
y_clean = y(find(~isnan(y)));

%1D
if size(xs_fit,2) == 1
    xq = x_range(1).range;
    pred_z = interp1(xs,y,xs_fit);
    if plot_it
        
        yq = interp1(xs,y,xq);
        [diff_1 pred_idx] = min(abs(xq - xs_fit));
        pred_z = yq(pred_idx);
        figure(1);
        plot(xs,y,'bo'); hold on;
        plot(xq,yq,'k');
        plot(xs_fit,pred_z,'r.','markersize',10);
        
        if (diff_1 > 5)
            warning('Prediction is out of interpolation boundaries');
        end
    end
    ylabel('Function value')
else
    %2D
    x1_range = x_range(1).range;
    x2_range = x_range(2).range;
    
    pred_z = griddata(xs_clean(:,1),xs_clean(:,2),y_clean,xs_fit(2),xs_fit(1));
    [diff_1 closest_idx_1] = min(abs(x1_range - xs_fit(1)));
    [diff_2 closest_idx_2] = min(abs(x2_range - xs_fit(2)));
    if ((diff_1 - max(x1_range)) < 5)
        xs_fit(1) = x1_range(closest_idx_1);
    end
    if ((diff_2 - max(x2_range)) < 5)
        xs_fit(2) = x2_range(closest_idx_2);
    end
    pred_z = griddata(xs_clean(:,1),xs_clean(:,2),y_clean,xs_fit(2),xs_fit(1));
    
    if plot_it
        [diff_1 closest_idx_1] = min(abs(x1_range - xs_fit(1)));
        [diff_2 closest_idx_2] = min(abs(x2_range - xs_fit(2)));
        
        [xq,yq] = meshgrid(x2_range,x1_range); %reverses x,y axis
        zq = griddata(xs_clean(:,1),xs_clean(:,2),y_clean,xq,yq);
        %[x1_range(closest_idx_1),x2_range(closest_idx_2)]
        pred_z = zq(closest_idx_1,closest_idx_2);
        
        figure(2);
        mesh(yq,xq,zq); hold on;
        plot3(xs_clean(:,2),xs_clean(:,1),y_clean,'bo');
        plot3(xs_fit(1),xs_fit(2),pred_z,'r.','markersize',30)
        
        xlabel('SR')
        ylabel('I')
        zlabel('Function')
        
        if (diff_1 > 5)| (diff_2 > 5)
            warning('Prediction is out of interpolation boundaries');
            
        end
    end
end

if (isnan(pred_z))
    warning('Prediction is out of interpolation boundaries');
end
end


function [I_in_t_block,I_S_t_PS_SP, I_switch_facils, pr_bend_per_S, prt_elim_S, down_slopes,up_slopes ] = load_params()

%t PP for S + I:
I_in_t_block = [      0  131.0000  200.0000
    4.5000  131.0000   25.0000
    9.0000  131.0000   25.0000
   13.5000  131.0000   25.0000
   18.0000  131.0000   25.0000
   22.5000  131.0000   14.0000
   27.0000  131.0000   13.0000
   31.5000  131.0000   12.0000
   36.0000  131.0000   11.0000
   40.5000  131.0000   10.0000
   45.0000  131.0000    9.9000
   49.5000  131.0000    6.0000
   54.0000  131.0000    5.5000
   58.5000  131.0000    5.4000
   63.0000  131.0000    5.4000
   67.5000  131.0000    5.4000
   72.0000  131.0000    5.4000
   76.5000  131.0000    5.4000
   81.0000  131.0000    5.4000
   85.5000  131.0000    5.4000
   90.0000  131.0000    5.4000
   96.0000  131.0000    4.8000
  108.0000  131.0000    4.7600
  120.0000  131.0000    4.7500
  132.0000  131.0000    4.4000
  144.0000  131.0000    4.7100
  156.0000  131.0000    4.7300
  168.0000  131.0000    4.7300
  180.0000  131.0000    4.7300
  192.0000  131.0000    4.7300
  204.0000  131.0000    4.7300
  216.0000  131.0000    5.1502
  228.0000  131.0000    5.1852
  240.0000  131.0000    5.5000
  252.0000  131.0000    6.2000
  264.0000  131.0000    7.0000
  276.0000  131.0000    7.7000
  288.0000  131.0000    8.3000
  300.0000  131.0000   16.2580
  312.0000  131.0000   31.6985
  324.0000  131.0000   68.5536
  336.0000  131.0000  156.5234
  348.0000  131.0000  366.4995
  360.0000  131.0000  867.6938
         0   85.9000  200.0000
    4.5000   85.9000   25.0000
    9.0000   85.9000   25.0000
   13.5000   85.9000   25.0000
   18.0000   85.9000   25.0000
   22.5000   85.9000   25.0000
   27.0000   85.9000   25.0000
   31.5000   85.9000   20.0000
   36.0000   85.9000   16.0000
   40.5000   85.9000   13.0000
   45.0000   85.9000   13.0000
   49.5000   85.9000   12.0000
   54.0000   85.9000   12.2000
   58.5000   85.9000   12.0000
   63.0000   85.9000    9.5000
   67.5000   85.9000    8.0000
   72.0000   85.9000    4.3000
   76.5000   85.9000    4.3000
   81.0000   85.9000    4.4000
   85.5000   85.9000    4.3000
   90.0000   85.9000    4.3000
   96.0000   85.9000    4.3000
  108.0000   85.9000    4.3000
  120.0000   85.9000    4.0000
  132.0000   85.9000    4.0000
  144.0000   85.9000    4.1000
  156.0000   85.9000    4.2000
  168.0000   85.9000    4.3000
  180.0000   85.9000    4.3000
  192.0000   85.9000    4.3000
  204.0000   85.9000    4.3000
  216.0000   85.9000    5.2200
  228.0000   85.9000    6.4000
  240.0000   85.9000    7.0000
  252.0000   85.9000   13.0000
  264.0000   85.9000   13.0000
  276.0000   85.9000   13.3000
  288.0000   85.9000   13.3000
  300.0000   85.9000   13.3000
  312.0000   85.9000   13.5000
  324.0000   85.9000   13.5536
  336.0000   85.9000   13.6000
  348.0000   85.9000  366.4995
  360.0000   85.9000  867.6938
         0   55.6900  200.0000
    4.5000   55.6900   30.0000
    9.0000   55.6900   30.0000
   13.5000   55.6900   30.0000
   18.0000   55.6900   30.0000
   22.5000   55.6900   29.0000
   27.0000   55.6900   28.0000
   31.5000   55.6900   27.0000
   36.0000   55.6900   27.0000
   40.5000   55.6900   23.0000
   45.0000   55.6900   16.0000
   49.5000   55.6900   14.0000
   54.0000   55.6900   13.2000
   58.5000   55.6900    5.5000
   63.0000   55.6900    5.5000
   67.5000   55.6900    5.5000
   72.0000   55.6900    5.3000
   76.5000   55.6900    5.2000
   81.0000   55.6900    5.0000
   85.5000   55.6900    4.7000
   90.0000   55.6900    4.7000
   96.0000   55.6900    4.7000
  108.0000   55.6900    4.7000
  120.0000   55.6900    4.7000
  132.0000   55.6900    4.7100
  144.0000   55.6900    4.7100
  156.0000   55.6900    4.7300
  168.0000   55.6900    4.7300
  180.0000   55.6900    4.8500
  192.0000   55.6900    5.1000
  204.0000   55.6900    5.1500
  216.0000   55.6900    5.1502
  228.0000   55.6900    5.8000
  240.0000   55.6900    7.0000
  252.0000   55.6900    8.0000
  264.0000   55.6900    8.0000
  276.0000   55.6900    9.0000
  288.0000   55.6900   13.0000
  300.0000   55.6900   16.2580
  312.0000   55.6900   31.6985
  324.0000   55.6900   68.5536
  336.0000   55.6900  156.5234
  348.0000   55.6900  366.4995
  360.0000   55.6900  867.6938
         0   29.4000  200.0000
    4.5000   29.4000   25.0000
    9.0000   29.4000   25.0000
   13.5000   29.4000   25.0000
   18.0000   29.4000   25.0000
   22.5000   29.4000   25.0000
   27.0000   29.4000   18.0000
   31.5000   29.4000   18.0000
   36.0000   29.4000   17.0000
   40.5000   29.4000   15.0000
   45.0000   29.4000   13.7500
   49.5000   29.4000    7.8000
   54.0000   29.4000    7.8000
   58.5000   29.4000    7.6000
   63.0000   29.4000    7.0000
   67.5000   29.4000    6.1000
   72.0000   29.4000    5.8000
   76.5000   29.4000    5.5000
   81.0000   29.4000    5.3000
   85.5000   29.4000    5.2000
   90.0000   29.4000    5.0000
   96.0000   29.4000    4.7000
  108.0000   29.4000    4.7000
  120.0000   29.4000    4.7000
  132.0000   29.4000    4.6500
  144.0000   29.4000    4.6500
  156.0000   29.4000    4.7300
  168.0000   29.4000    4.7300
  180.0000   29.4000    4.7300
  192.0000   29.4000    5.0000
  204.0000   29.4000    5.0000
  216.0000   29.4000    5.8000
  228.0000   29.4000    6.2000
  240.0000   29.4000    6.6000
  252.0000   29.4000    7.0000
  264.0000   29.4000    8.2000
  276.0000   29.4000   10.7000
  288.0000   29.4000   11.7000
  300.0000   29.4000   16.2580
  312.0000   29.4000   31.6985
  324.0000   29.4000   68.5536
  336.0000   29.4000  156.5234
  348.0000   29.4000  366.4995
  360.0000   29.4000  867.6938
         0   12.9000  200.0000
    4.5000   12.9000   25.0000
    9.0000   12.9000   25.0000
   13.5000   12.9000   25.0000
   18.0000   12.9000   25.0000
   22.5000   12.9000   25.0000
   27.0000   12.9000   25.0000
   31.5000   12.9000   20.0000
   36.0000   12.9000   20.0000
   40.5000   12.9000   18.7000
   45.0000   12.9000   17.8000
   49.5000   12.9000   12.6000
   54.0000   12.9000   11.6000
   58.5000   12.9000   10.5000
   63.0000   12.9000    8.8000
   67.5000   12.9000    7.3000
   72.0000   12.9000    6.4000
   76.5000   12.9000    5.8000
   81.0000   12.9000    5.6000
   85.5000   12.9000    5.4000
   90.0000   12.9000    5.1000
   96.0000   12.9000    4.8000
  108.0000   12.9000    4.7600
  120.0000   12.9000    4.7500
  132.0000   12.9000    4.7100
  144.0000   12.9000    4.7100
  156.0000   12.9000    4.7300
  168.0000   12.9000    4.7500
  180.0000   12.9000    4.7800
  192.0000   12.9000    4.8200
  204.0000   12.9000    5.0000
  216.0000   12.9000    5.3020
  228.0000   12.9000    5.8000
  240.0000   12.9000    6.3000
  252.0000   12.9000    7.0000
  264.0000   12.9000    7.8000
  276.0000   12.9000    9.0000
  288.0000   12.9000   11.3000
  300.0000   12.9000   15.0000
  312.0000   12.9000   31.6985
  324.0000   12.9000   68.5536
  336.0000   12.9000  156.5234
  348.0000   12.9000  366.4995
  360.0000   12.9000  867.6938
         0    7.0500  200.0000
    4.5000    7.0500   25.0000
    9.0000    7.0500   25.0000
   13.5000    7.0500   25.0000
   18.0000    7.0500   25.0000
   22.5000    7.0500   25.0000
   27.0000    7.0500   25.0000
   31.5000    7.0500   20.0000
   36.0000    7.0500   20.0000
   40.5000    7.0500   18.0000
   45.0000    7.0500   16.0000
   49.5000    7.0500   13.0000
   54.0000    7.0500   13.2000
   58.5000    7.0500   12.7000
   63.0000    7.0500    9.6000
   67.5000    7.0500    8.1000
   72.0000    7.0500    7.0000
   76.5000    7.0500    6.1000
   81.0000    7.0500    5.8000
   85.5000    7.0500    5.5000
   90.0000    7.0500    5.4000
   96.0000    7.0500    4.8000
  108.0000    7.0500    4.7600
  120.0000    7.0500    4.7500
  132.0000    7.0500    4.7100
  144.0000    7.0500    4.7100
  156.0000    7.0500    4.7300
  168.0000    7.0500    4.7300
  180.0000    7.0500    4.7600
  192.0000    7.0500    4.9000
  204.0000    7.0500    5.0000
  216.0000    7.0500    5.3020
  228.0000    7.0500    5.3520
  240.0000    7.0500    5.7000
  252.0000    7.0500    6.2000
  264.0000    7.0500    7.0000
  276.0000    7.0500    7.3000
  288.0000    7.0500    8.0000
  300.0000    7.0500   13.2580
  312.0000    7.0500   31.6985
  324.0000    7.0500   68.5536
  336.0000    7.0500  156.5234
  348.0000    7.0500  366.4995
  360.0000    7.0500  867.6938
         0         0  200.0000
    4.5000         0   25.0000
    9.0000         0   25.0000
   13.5000         0   25.0000
   18.0000         0   25.0000
   22.5000         0   25.0000
   27.0000         0   25.0000
   31.5000         0   20.0000
   36.0000         0   20.0000
   40.5000         0   20.0000
   45.0000         0   20.0000
   49.5000         0   14.5000
   54.0000         0   13.4000
   58.5000         0   12.6000
   63.0000         0   10.2500
   67.5000         0    8.6000
   72.0000         0    7.0000
   76.5000         0    6.1000
   81.0000         0    5.8000
   85.5000         0    5.5000
   90.0000         0    5.4000
   96.0000         0    4.8000
  108.0000         0    4.7600
  120.0000         0    4.7500
  132.0000         0    4.7100
  144.0000         0    4.7100
  156.0000         0    4.7300
  168.0000         0    4.7300
  180.0000         0    4.7300
  192.0000         0    4.7300
  204.0000         0    4.7300
  216.0000         0    5.1502
  228.0000         0    5.1852
  240.0000         0    5.5000
  252.0000         0    6.2000
  264.0000         0    7.0000
  276.0000         0    7.7000
  288.0000         0    8.3000
  300.0000         0   16.2580
  312.0000         0   31.6985
  324.0000         0   68.5536
  336.0000         0  156.5234
  348.0000         0  366.4995
  360.0000         0  867.6938];

%up slopes when have bend: (S blocking P):
up_slopes = [  0  130.0000         0
         0   86.0000         0
         0   56.0000         0
         0   29.0000         0
         0   12.0000         0
         0    7.0000         0
         0         0         0
    4.5000  130.0000   -0.0057
    4.5000   86.0000    0.0014
    4.5000   56.0000         0
    4.5000   29.0000         0
    4.5000   12.0000         0
    4.5000    7.0000         0
    4.5000         0         0
    9.5000  130.0000   -0.0171
    9.5000   86.0000    0.0057
    9.5000   56.0000    0.0057
    9.5000   29.0000         0
    9.5000   12.0000         0
    9.5000    7.0000         0
    9.5000         0         0
   13.5000  130.0000   -0.0171
   13.5000   86.0000    0.0057
   13.5000   56.0000    0.0057
   13.5000   29.0000         0
   13.5000   12.0000         0
   13.5000    7.0000         0
   13.5000         0         0
   18.0000  130.0000   -0.0171
   18.0000   86.0000    0.0071
   18.0000   56.0000    0.0171
   18.0000   29.0000    0.0114
   18.0000   12.0000    0.0057
   18.0000    7.0000    0.0057
   18.0000         0         0
   22.5000  130.0000   -0.0171
   22.5000   86.0000    0.0114
   22.5000   56.0000    0.0229
   22.5000   29.0000    0.0129
   22.5000   12.0000    0.0071
   22.5000    7.0000    0.0057
   22.5000         0         0
   27.0000  130.0000   -0.0200
   27.0000   86.0000    0.0171
   27.0000   56.0000    0.0343
   27.0000   29.0000    0.0286
   27.0000   12.0000    0.0171
   27.0000    7.0000    0.0129
   27.0000         0         0
   31.5000  130.0000   -0.0171
   31.5000   86.0000    0.0286
   31.5000   56.0000    0.0457
   31.5000   29.0000    0.0371
   31.5000   12.0000    0.0286
   31.5000    7.0000    0.0200
   31.5000         0         0
   36.0000  130.0000   -0.0380
   36.0000   86.0000    0.0090
   36.0000   56.0000    0.0863
   36.0000   29.0000    0.0866
   36.0000   12.0000    0.0730
   36.0000    7.0000    0.0443
   36.0000         0         0
   40.5000  130.0000   -0.0333
   40.5000   86.0000    0.0269
   40.5000   56.0000    0.1021
   40.5000   29.0000    0.1281
   40.5000   12.0000    0.1175
   40.5000    7.0000    0.0671
   40.5000         0         0
   45.0000  130.0000   -0.0387
   45.0000   86.0000    0.0554
   45.0000   56.0000    0.1218
   45.0000   29.0000    0.1878
   45.0000   12.0000    0.1748
   45.0000    7.0000    0.1220
   45.0000         0         0
   49.5000  130.0000   -0.0467
   49.5000   86.0000    0.0588
   49.5000   56.0000    0.1545
   49.5000   29.0000    0.2425
   49.5000   12.0000    0.2941
   49.5000    7.0000    0.2469
   49.5000         0         0
   54.0000  130.0000   -0.0326
   54.0000   86.0000    0.0756
   54.0000   56.0000    0.1902
   54.0000   29.0000    0.3921
   54.0000   12.0000    0.5098
   54.0000    7.0000    0.4604
   54.0000         0         0
   58.5000  130.0000   -0.0376
   58.5000   86.0000    0.0867
   58.5000   56.0000    0.2801
   58.5000   29.0000    0.5011
   58.5000   12.0000    0.6972
   58.5000    7.0000    0.8333
   58.5000         0    1.0000
   63.0000  130.0000   -0.0322
   63.0000   86.0000    0.0962
   63.0000   56.0000    0.2614
   63.0000   29.0000    0.4576
   63.0000   12.0000    0.6765
   63.0000    7.0000    0.7500
   63.0000         0    1.0000
   67.5000  130.0000         0
   67.5000   86.0000    0.0940
   67.5000   56.0000    0.2832
   67.5000   29.0000    0.5071
   67.5000   12.0000    0.7445
   67.5000    7.0000    0.8074
   67.5000         0    1.0000
   72.0000  130.0000         0
   72.0000   86.0000    0.0817
   72.0000   56.0000    0.2968
   72.0000   29.0000    0.5207
   72.0000   12.0000    0.7843
   72.0000    7.0000    0.8103
   72.0000         0    1.0000
   76.5000  130.0000         0
   76.5000   86.0000    0.1122
   76.5000   56.0000    0.3395
   76.5000   29.0000    0.5112
   76.5000   12.0000    0.7657
   76.5000    7.0000    0.8074
   76.5000         0    1.0000
   81.0000  130.0000         0
   81.0000   86.0000    0.1310
   81.0000   56.0000    0.3137
   81.0000   29.0000    0.5503
   81.0000   12.0000    0.7632
   81.0000    7.0000    0.8188
   81.0000         0    1.0000
   85.5000  130.0000   -0.0077
   85.5000   86.0000    0.1281
   85.5000   56.0000    0.3339
   85.5000   29.0000    0.6196
   85.5000   12.0000    0.7698
   85.5000    7.0000    0.8606
   85.5000         0    1.0000
   90.0000  130.0000   -0.0181
   90.0000   86.0000    0.1230
   90.0000   56.0000    0.3334
   90.0000   29.0000    0.5817
   90.0000   12.0000    0.7598
   90.0000    7.0000    0.8606
   90.0000         0    1.0000
   96.0000  130.0000   -0.0300
   96.0000   86.0000    0.1300
   96.0000   56.0000    0.3000
   96.0000   29.0000    0.4700
   96.0000   12.0000    0.7500
   96.0000    7.0000    0.8916
   96.0000         0    1.0000
  108.0000  130.0000   -0.0300
  108.0000   86.0000    0.1300
  108.0000   56.0000    0.3200
  108.0000   29.0000    0.5000
  108.0000   12.0000    0.7616
  108.0000    7.0000    0.8627
  108.0000         0    1.0000
  120.0000  130.0000   -0.0300
  120.0000   86.0000    0.1300
  120.0000   56.0000    0.3300
  120.0000   29.0000    0.4600
  120.0000   12.0000    0.7676
  120.0000    7.0000    0.8512
  120.0000         0    1.0000
  132.0000  130.0000   -0.0300
  132.0000   86.0000    0.1200
  132.0000   56.0000    0.3100
  132.0000   29.0000    0.4800
  132.0000   12.0000    0.7555
  132.0000    7.0000    0.8627
  132.0000         0    1.0000
  144.0000  130.0000   -0.0210
  144.0000   86.0000    0.1000
  144.0000   56.0000    0.2900
  144.0000   29.0000    0.4800
  144.0000   12.0000    0.7676
  144.0000    7.0000    0.8512
  144.0000         0    1.0000
  156.0000  130.0000   -0.0300
  156.0000   86.0000    0.0900
  156.0000   56.0000    0.2800
  156.0000   29.0000    0.4800
  156.0000   12.0000    0.7256
  156.0000    7.0000    0.8236
  156.0000         0    1.0000
  168.0000  130.0000   -0.0300
  168.0000   86.0000    0.0528
  168.0000   56.0000    0.2700
  168.0000   29.0000    0.4900
  168.0000   12.0000    0.7432
  168.0000    7.0000    0.8512
  168.0000         0    1.0000
  180.0000  130.0000   -0.0300
  180.0000   86.0000    0.0423
  180.0000   56.0000    0.2400
  180.0000   29.0000    0.4706
  180.0000   12.0000    0.7562
  180.0000    7.0000    0.8889
  180.0000         0    1.0000
  192.0000  130.0000   -0.0277
  192.0000   86.0000    0.0285
  192.0000   56.0000    0.2100
  192.0000   29.0000    0.4900
  192.0000   12.0000    0.7417
  192.0000    7.0000    0.8512
  192.0000         0    1.0000
  204.0000  130.0000   -0.0210
  204.0000   86.0000         0
  204.0000   56.0000    0.1900
  204.0000   29.0000    0.4600
  204.0000   12.0000    0.7507
  204.0000    7.0000    0.8571
  204.0000         0    1.0000
  216.0000  130.0000   -0.0288
  216.0000   86.0000   -0.0300
  216.0000   56.0000    0.2000
  216.0000   29.0000    0.4200
  216.0000   12.0000    0.7058
  216.0000    7.0000    0.7914
  216.0000         0    1.0000
  228.0000  130.0000    0.0026
  228.0000   86.0000   -0.0300
  228.0000   56.0000    0.1200
  228.0000   29.0000    0.3700
  228.0000   12.0000    0.7058
  228.0000    7.0000    0.8404
  228.0000         0    1.0000
  240.0000  130.0000   -0.0405
  240.0000   86.0000   -0.0817
  240.0000   56.0000    0.0677
  240.0000   29.0000    0.3000
  240.0000   12.0000    0.6430
  240.0000    7.0000    0.7880
  240.0000         0    1.0000
  252.0000  130.0000   -0.0339
  252.0000   86.0000   -0.0574
  252.0000   56.0000   -0.0150
  252.0000   29.0000    0.2500
  252.0000   12.0000    0.5556
  252.0000    7.0000    0.7595
  252.0000         0    1.0000
  264.0000  130.0000         0
  264.0000   86.0000   -0.0500
  264.0000   56.0000   -0.0600
  264.0000   29.0000    0.1200
  264.0000   12.0000    0.4484
  264.0000    7.0000    0.7058
  264.0000         0    1.0000
  276.0000  130.0000    0.0033
  276.0000   86.0000   -0.0500
  276.0000   56.0000   -0.0900
  276.0000   29.0000         0
  276.0000   12.0000    0.2353
  276.0000    7.0000    0.4491
  276.0000         0    1.0000
  288.0000  130.0000   -0.0093
  288.0000   86.0000   -0.0500
  288.0000   56.0000   -0.1100
  288.0000   29.0000   -0.1100
  288.0000   12.0000   -0.0300
  288.0000    7.0000    0.1711
  288.0000         0    1.0000
  300.0000  130.0000         0
  300.0000   86.0000   -0.0500
  300.0000   56.0000   -0.1368
  300.0000   29.0000   -0.1022
  300.0000   12.0000   -0.1000
  300.0000    7.0000   -0.0304
  300.0000         0         0
  312.0000  130.0000         0
  312.0000   86.0000   -0.0311
  312.0000   56.0000   -0.1200
  312.0000   29.0000   -0.1400
  312.0000   12.0000   -0.0972
  312.0000    7.0000   -0.0455
  312.0000         0         0
  324.0000  130.0000         0
  324.0000   86.0000   -0.0400
  324.0000   56.0000   -0.1248
  324.0000   29.0000   -0.1500
  324.0000   12.0000   -0.1300
  324.0000    7.0000   -0.1000
  324.0000         0         0
  336.0000  130.0000         0
  336.0000   86.0000   -0.0400
  336.0000   56.0000   -0.1250
  336.0000   29.0000   -0.1700
  336.0000   12.0000   -0.1700
  336.0000    7.0000   -0.1300
  336.0000         0         0
  348.0000  130.0000         0
  348.0000   86.0000   -0.0600
  348.0000   56.0000   -0.1500
  348.0000   29.0000   -0.1800
  348.0000   12.0000   -0.1800
  348.0000    7.0000   -0.1300
  348.0000         0         0
  360.0000  130.0000         0
  360.0000   86.0000   -0.0700
  360.0000   56.0000   -0.1600
  360.0000   29.0000   -0.2000
  360.0000   12.0000   -0.1900
  360.0000    7.0000   -0.1900
  360.0000         0   -0.1300];

%P block S per S + I:
down_slopes = [ 156.0000   -0.0500  130.0000  131.0000
  156.0000         0         0   85.0000
  156.0000         0         0   55.0000
  156.0000         0         0   40.0000
  156.0000         0         0   13.4000
  156.0000         0         0    5.8800
  156.0000         0         0         0
  168.0000   -0.0800  130.0000  131.0000
  168.0000         0         0   85.0000
  168.0000         0         0   55.0000
  168.0000         0         0   40.0000
  168.0000         0         0   13.4000
  168.0000         0         0    5.8800
  168.0000         0         0         0
  180.0000   -0.0800  130.0000  131.0000
  180.0000         0         0   85.0000
  180.0000         0         0   55.0000
  180.0000         0         0   40.0000
  180.0000         0         0   13.4000
  180.0000         0         0    5.8800
  180.0000         0         0         0
  192.0000   -0.0900  130.0000  131.0000
  192.0000   -0.0400   80.0000   85.0000
  192.0000         0         0   55.0000
  192.0000         0         0   40.0000
  192.0000         0         0   13.4000
  192.0000         0         0    5.8800
  192.0000         0         0         0
  204.0000   -0.1200  130.0000  131.0000
  204.0000   -0.0300   80.0000   85.0000
  204.0000         0         0   55.0000
  204.0000         0         0   40.0000
  204.0000         0         0   13.4000
  204.0000         0         0    5.8800
  204.0000         0         0         0
  216.0000   -0.1500  130.0000  131.0000
  216.0000   -0.0900   80.0000   85.0000
  216.0000   -0.0200   40.0000   55.0000
  216.0000         0         0   30.0000
  216.0000         0         0   13.4000
  216.0000         0         0    5.8800
  216.0000         0         0         0
  228.0000   -0.2100  130.0000  131.0000
  228.0000   -0.1000   80.0000   85.0000
  228.0000   -0.0400   40.0000   55.0000
  228.0000         0         0   30.0000
  228.0000         0         0   13.4000
  228.0000         0         0    5.8800
  228.0000         0         0         0
  240.0000   -0.2100  130.0000  131.0000
  240.0000   -0.1300   80.0000   85.0000
  240.0000   -0.0700   40.0000   55.0000
  240.0000         0         0   30.0000
  240.0000         0         0   13.4000
  240.0000         0         0    5.8800
  240.0000         0         0         0
  252.0000   -0.2125  130.0000  131.0000
  252.0000   -0.1479   80.0000   85.0000
  252.0000   -0.0800   40.0000   55.0000
  252.0000   -0.0800   52.0000   30.0000
  252.0000   -0.0300   30.0000   13.4000
  252.0000   -0.0493   18.0000    5.8800
  252.0000         0         0         0
  264.0000   -0.2389  130.0000  131.0000
  264.0000   -0.1912   80.0000   85.0000
  264.0000   -0.1223   40.0000   55.0000
  264.0000   -0.0800   52.0000   30.0000
  264.0000   -0.0600   32.0000   13.4000
  264.0000   -0.0400         0    5.8800
  264.0000         0         0         0
  276.0000   -0.2500  142.0000  131.0000
  276.0000   -0.2400   80.0000   85.0000
  276.0000   -0.1500   40.0000   55.0000
  276.0000   -0.0900   72.0000   30.0000
  276.0000   -0.0500   34.0000   13.4000
  276.0000   -0.0400   20.0000    5.8800
  276.0000         0         0         0
  288.0000   -0.2900  140.0000  131.0000
  288.0000   -0.2700   60.0000   85.0000
  288.0000   -0.1672   40.0000   55.0000
  288.0000   -0.1200   64.0000   30.0000
  288.0000   -0.0500   34.0000   13.4000
  288.0000   -0.0400   20.0000    5.8800
  288.0000         0         0         0
  300.0000   -0.2900  152.0000  131.0000
  300.0000   -0.2900   80.0000   85.0000
  300.0000   -0.2200   40.0000   55.0000
  300.0000   -0.1600   20.0000   30.0000
  300.0000   -0.0672   36.0000   13.4000
  300.0000   -0.0600         0    5.8800
  300.0000         0         0         0
  312.0000   -0.3200  152.0000  131.0000
  312.0000   -0.3300   80.0000   85.0000
  312.0000   -0.2673   40.0000   55.0000
  312.0000   -0.2000   19.0000   30.0000
  312.0000   -0.0941         0   13.4000
  312.0000   -0.0659         0    5.8800
  312.0000         0         0         0
  324.0000   -0.3600  152.0000  131.0000
  324.0000   -0.3600   80.0000   85.0000
  324.0000   -0.2933   40.0000   55.0000
  324.0000   -0.2400   20.0000   30.0000
  324.0000   -0.1059         0   13.4000
  324.0000   -0.0642         0    5.8800
  324.0000         0         0         0
  336.0000   -0.4000  151.0000  131.0000
  336.0000   -0.3900   75.0000   85.0000
  336.0000   -0.3600   40.0000   55.0000
  336.0000   -0.2800   20.0000   30.0000
  336.0000   -0.1300   26.0000   13.4000
  336.0000   -0.1029   24.0000    5.8800
  336.0000         0         0         0
  348.0000   -0.4500  154.0000  131.0000
  348.0000   -0.4200   60.0000   85.0000
  348.0000   -0.4000   40.0000   55.0000
  348.0000   -0.3500   20.0000   30.0000
  348.0000   -0.1700   28.0000   13.4000
  348.0000   -0.0986   24.0000    5.8800
  348.0000         0         0         0
  360.0000   -0.4700  148.0000  131.0000
  360.0000   -0.5000   60.0000   85.0000
  360.0000   -0.5200   40.0000   55.0000
  360.0000   -0.4800   26.0000   30.0000
  360.0000   -0.2000   30.0000   13.4000
  360.0000   -0.1098   20.0000    5.8800
  360.0000   -0.1000         0         0];

% slope/perc affect P-->S and S-->P
I_S_t_PS_SP = [    0  131.0000         0         0
    4.5000  131.0000   -0.0002         0
    9.5000  131.0000   -0.0006         0
   13.5000  131.0000   -0.0008         0
   18.0000  131.0000   -0.0008         0
   22.5000  131.0000   -0.0008         0
   27.0000  131.0000   -0.0010    0.0001
   31.5000  131.0000    0.0060    0.0006
   36.0000  131.0000    0.0037    0.0037
   40.5000  131.0000    0.0219    0.0100
   45.0000  131.0000    0.1192    0.0200
   49.5000  131.0000    0.4502    0.3000
   54.0000  131.0000    0.8320    0.8320
   58.5000  131.0000    0.9677    0.9677
   63.0000  131.0000    0.9945    0.9945
   67.5000  131.0000    0.9991    0.9991
   72.0000  131.0000    0.9998    0.9998
   76.5000  131.0000    1.0000    1.0000
   81.0000  131.0000    1.0000    1.0000
   85.5000  131.0000    1.0000    1.0000
   90.0000  131.0000    1.0000    1.0000
   96.0000  131.0000    1.0000    1.0000
  108.0000  131.0000    1.0000    1.0000
  120.0000  131.0000    1.0000    1.0000
  132.0000  131.0000    1.0000    1.0000
  144.0000  131.0000    1.0000    1.0000
  156.0000  131.0000    1.0000    1.0000
  168.0000  131.0000    1.0000    1.0000
  180.0000  131.0000    1.0000    1.0000
  192.0000  131.0000    1.0000    1.0000
  204.0000  131.0000    1.0000    0.5000
  216.0000  131.0000    1.0000    0.4000
  228.0000  131.0000    1.0000    0.3400
  240.0000  131.0000    1.0000    0.3000
  252.0000  131.0000    1.0000    0.3000
  264.0000  131.0000    1.0000    0.1000
  276.0000  131.0000    1.0000    0.1000
  288.0000  131.0000    1.0000    0.1000
  300.0000  131.0000    1.0000         0
  312.0000  131.0000    1.0000         0
  324.0000  131.0000    1.0000         0
  336.0000  131.0000    1.0000         0
  348.0000  131.0000    1.0000         0
  360.0000  131.0000    1.0000         0
         0   85.9000         0         0
    4.5000   85.9000    0.0001    0.0001
    9.5000   85.9000    0.0002    0.0030
   13.5000   85.9000    0.0003    0.0040
   18.0000   85.9000    0.0005    0.0100
   22.5000   85.9000    0.0008    0.2000
   27.0000   85.9000    0.0010    0.3000
   31.5000   85.9000    0.0014    0.3000
   36.0000   85.9000    0.0037    0.3000
   40.5000   85.9000    0.0219    0.6500
   45.0000   85.9000    0.1192    0.7000
   49.5000   85.9000    0.4502    0.7800
   54.0000   85.9000    0.8320    0.8800
   58.5000   85.9000    0.9677    0.9200
   63.0000   85.9000    0.9945    0.9300
   67.5000   85.9000    0.9991    0.9400
   72.0000   85.9000    0.9998    0.9500
   76.5000   85.9000    1.0000    0.9600
   81.0000   85.9000    1.0000    0.9700
   85.5000   85.9000    1.0000    0.9800
   90.0000   85.9000    1.0000    1.0000
   96.0000   85.9000    1.0000    1.0000
  108.0000   85.9000    1.0000    1.0000
  120.0000   85.9000    1.0000    1.0000
  132.0000   85.9000    1.0000    1.0000
  144.0000   85.9000    1.0000    1.0000
  156.0000   85.9000    1.0000    1.0000
  168.0000   85.9000    1.0000    1.0000
  180.0000   85.9000    1.0000    1.0000
  192.0000   85.9000    1.0000    1.0000
  204.0000   85.9000    1.0000    1.0000
  216.0000   85.9000    1.0000    1.0000
  228.0000   85.9000    1.0000    0.6000
  240.0000   85.9000    1.0000    0.5500
  252.0000   85.9000    1.0000    0.3000
  264.0000   85.9000    1.0000    0.3000
  276.0000   85.9000    1.0000    0.3000
  288.0000   85.9000    1.0000    0.3000
  300.0000   85.9000    1.0000    0.1000
  312.0000   85.9000    1.0000    0.1000
  324.0000   85.9000    1.0000    0.1000
  336.0000   85.9000    1.0000         0
  348.0000   85.9000    1.0000         0
  360.0000   85.9000    1.0000         0
         0   55.6900         0         0
    4.5000   55.6900    0.0001    0.0010
    9.5000   55.6900    0.0004    0.0010
   13.5000   55.6900    0.0008    0.0010
   18.0000   55.6900    0.0014    0.0010
   22.5000   55.6900    0.0020    0.0010
   27.0000   55.6900    0.0030    0.3000
   31.5000   55.6900    0.0035    0.4000
   36.0000   55.6900    0.0045    0.5000
   40.5000   55.6900    0.0060    0.5400
   45.0000   55.6900    0.0075    0.5500
   49.5000   55.6900    0.0100    0.5600
   54.0000   55.6900    0.0120    0.5800
   58.5000   55.6900    0.9677    0.8200
   63.0000   55.6900    0.9945    0.9300
   67.5000   55.6900    0.9991    0.9991
   72.0000   55.6900    0.9998    0.9998
   76.5000   55.6900    1.0000    1.0000
   81.0000   55.6900    1.0000    1.0000
   85.5000   55.6900    1.0000    1.0000
   90.0000   55.6900    1.0000    1.0000
   96.0000   55.6900    1.0000    1.0000
  108.0000   55.6900    1.0000    1.0000
  120.0000   55.6900    1.0000    1.0000
  132.0000   55.6900    1.0000    1.0000
  144.0000   55.6900    1.0000    1.0000
  156.0000   55.6900    1.0000    1.0000
  168.0000   55.6900    1.0000    1.0000
  180.0000   55.6900    1.0000    1.0000
  192.0000   55.6900    1.0000    1.0000
  204.0000   55.6900    1.0000    1.0000
  216.0000   55.6900    1.0000    1.0000
  228.0000   55.6900    1.0000    0.9500
  240.0000   55.6900    1.0000    0.8800
  252.0000   55.6900    1.0000    0.7200
  264.0000   55.6900    1.0000    0.3500
  276.0000   55.6900    1.0000    0.1500
  288.0000   55.6900    1.0000    0.1000
  300.0000   55.6900    1.0000    0.1000
  312.0000   55.6900    1.0000         0
  324.0000   55.6900    1.0000         0
  336.0000   55.6900    1.0000         0
  348.0000   55.6900    1.0000         0
  360.0000   55.6900    1.0000         0
         0   29.4000         0         0
    4.5000   29.4000    0.0001         0
    9.5000   29.4000    0.0003    0.0100
   13.5000   29.4000    0.0005    0.0100
   18.0000   29.4000    0.0013    0.0100
   22.5000   29.4000    0.0018    0.0100
   27.0000   29.4000    0.0022    0.2000
   31.5000   29.4000    0.0045    0.2800
   36.0000   29.4000    0.0050    0.3600
   40.5000   29.4000    0.0219    0.8000
   45.0000   29.4000    0.1192    0.8000
   49.5000   29.4000    0.42    0.8500
   54.0000   29.4000    0.8320    0.8800
   58.5000   29.4000    0.9677    0.9000
   63.0000   29.4000    0.9945    1.0000
   67.5000   29.4000    1.0000    1.0000
   72.0000   29.4000    1.0000    1.0000
   76.5000   29.4000    1.0000    1.0000
   81.0000   29.4000    1.0000    1.0000
   85.5000   29.4000    1.0000    1.0000
   90.0000   29.4000    1.0000    1.0000
   96.0000   29.4000    1.0000    1.0000
  108.0000   29.4000    1.0000    1.0000
  120.0000   29.4000    1.0000    1.0000
  132.0000   29.4000    1.0000    1.0000
  144.0000   29.4000    1.0000    1.0000
  156.0000   29.4000    1.0000    1.0000
  168.0000   29.4000    1.0000    1.0000
  180.0000   29.4000    1.0000    1.0000
  192.0000   29.4000    1.0000    1.0000
  204.0000   29.4000    1.0000    1.0000
  216.0000   29.4000    1.0000    1.0000
  228.0000   29.4000    1.0000    1.0000
  240.0000   29.4000    1.0000    1.0000
  252.0000   29.4000    1.0000    1.0000
  264.0000   29.4000    1.0000    0.8000
  276.0000   29.4000    1.0000    0.4000
  288.0000   29.4000    1.0000    0.2000
  300.0000   29.4000    1.0000    0.1000
  312.0000   29.4000    1.0000         0
  324.0000   29.4000    1.0000         0
  336.0000   29.4000    1.0000         0
  348.0000   29.4000    1.0000         0
  360.0000   29.4000    1.0000         0
         0   12.9000         0         0
    4.5000   12.9000    0.0001    0.0001
    9.5000   12.9000    0.0002    0.0001
   13.5000   12.9000    0.0003    0.0001
   18.0000   12.9000    0.0006    0.0001
   22.5000   12.9000    0.0010    0.0001
   27.0000   12.9000    0.0018    0.0006
   31.5000   12.9000    0.0022    0.2600
   36.0000   12.9000    0.0042    0.3000
   40.5000   12.9000    0.0219    0.4000
   45.0000   12.9000    0.1192    0.6800
   49.5000   12.9000    0.4502    0.8500
   54.0000   12.9000    0.8320    0.9500
   58.5000   12.9000    0.9677    0.9600
   63.0000   12.9000    0.9945    0.9700
   67.5000   12.9000    0.9991    0.9991
   72.0000   12.9000    0.9998    0.9998
   76.5000   12.9000    1.0000    1.0000
   81.0000   12.9000    1.0000    1.0000
   85.5000   12.9000    1.0000    1.0000
   90.0000   12.9000    1.0000    1.0000
   96.0000   12.9000    1.0000    1.0000
  108.0000   12.9000    1.0000    1.0000
  120.0000   12.9000    1.0000    1.0000
  132.0000   12.9000    1.0000    1.0000
  144.0000   12.9000    1.0000    1.0000
  156.0000   12.9000    1.0000    1.0000
  168.0000   12.9000    1.0000    1.0000
  180.0000   12.9000    1.0000    1.0000
  192.0000   12.9000    1.0000    1.0000
  204.0000   12.9000    1.0000    1.0000
  216.0000   12.9000    1.0000    1.0000
  228.0000   12.9000    1.0000    1.0000
  240.0000   12.9000    1.0000    0.9500
  252.0000   12.9000    1.0000    0.9500
  264.0000   12.9000    1.0000    0.9400
  276.0000   12.9000    1.0000    0.8000
  288.0000   12.9000    1.0000    0.3000
  300.0000   12.9000    1.0000    0.0800
  312.0000   12.9000    1.0000         0
  324.0000   12.9000    1.0000         0
  336.0000   12.9000    1.0000         0
  348.0000   12.9000    1.0000         0
  360.0000   12.9000    1.0000         0
         0    7.0500         0         0
    4.5000    7.0500    0.0001    0.0300
    9.5000    7.0500    0.0002    0.0300
   13.5000    7.0500    0.0003    0.0500
   18.0000    7.0500    0.0006    0.0600
   22.5000    7.0500    0.0009    0.0800
   27.0000    7.0500    0.0013    0.1100
   31.5000    7.0500    0.0016    0.1800
   36.0000    7.0500    0.002    0.27
   40.5000    7.0500    0.0040    0.2900
   45.0000    7.0500    0.0040    0.420
   49.5000    7.0500    0.0080    0.600
   54.0000    7.0500    0.3000    .9800
   58.5000    7.0500    0.0500    1.0000
   63.0000    7.0500    0.9900    1.0000
   67.5000    7.0500    0.9991    1.0000
   72.0000    7.0500    1.0000    1.0000
   76.5000    7.0500    1.0000    1.0000
   81.0000    7.0500    1.0000    1.0000
   85.5000    7.0500    1.0000    1.0000
   90.0000    7.0500    1.0000    1.0000
   96.0000    7.0500    1.0000    1.0000
  108.0000    7.0500    1.0000    1.0000
  120.0000    7.0500    1.0000    1.0000
  132.0000    7.0500    1.0000    1.0000
  144.0000    7.0500    1.0000    1.0000
  156.0000    7.0500    1.0000    1.0000
  168.0000    7.0500    1.0000    1.0000
  180.0000    7.0500    1.0000    1.0000
  192.0000    7.0500    1.0000    1.0000
  204.0000    7.0500    1.0000    1.0000
  216.0000    7.0500    1.0000    1.0000
  228.0000    7.0500    1.0000    1.0000
  240.0000    7.0500    1.0000    1.0000
  252.0000    7.0500    1.0000    1.0000
  264.0000    7.0500    1.0000    1.0000
  276.0000    7.0500    1.0000    0.9000
  288.0000    7.0500    1.0000    0.5300
  300.0000    7.0500    1.0000    0.1000
  312.0000    7.0500    1.0000         0
  324.0000    7.0500    1.0000         0
  336.0000    7.0500    1.0000         0
  348.0000    7.0500    1.0000         0
  360.0000    7.0500    1.0000         0
         0         0         0         0
    4.5000         0         0         0
    9.5000         0         0         0
   13.5000         0         0         0
   18.0000         0         0         0
   22.5000         0         0         0
   27.0000         0    0.0001    0.0001
   31.5000         0    0.0006    0.0006
   36.0000         0    0.0037    0.0037
   40.5000         0    0.0100    0.0100
   45.0000         0    0.0100    0.0600
   49.5000         0    0.0160    0.8000
   54.0000         0    0.0430    0.8400
   58.5000         0    0.0800    1.0000
   63.0000         0    0.3000    1.0000
   67.5000         0    0.9991    1.0000
   72.0000         0    0.9998    0.9998
   76.5000         0    1.0000    1.0000
   81.0000         0    1.0000    1.0000
   85.5000         0    1.0000    1.0000
   90.0000         0    1.0000    1.0000
   96.0000         0    1.0000    1.0000
  108.0000         0    1.0000    1.0000
  120.0000         0    1.0000    1.0000
  132.0000         0    1.0000    1.0000
  144.0000         0    1.0000    1.0000
  156.0000         0    1.0000    1.0000
  168.0000         0    1.0000    1.0000
  180.0000         0    1.0000    1.0000
  192.0000         0    1.0000    1.0000
  204.0000         0    1.0000    1.0000
  216.0000         0    1.0000    1.0000
  228.0000         0    1.0000    1.0000
  240.0000         0    1.0000    1.0000
  252.0000         0    1.0000    1.0000
  264.0000         0    1.0000    1.0000
  276.0000         0    1.0000    1.0000
  288.0000         0    1.0000    1.0000
  300.0000         0    1.0000         0
  312.0000         0    1.0000         0
  324.0000         0    1.0000         0
  336.0000         0    1.0000         0
  348.0000         0    1.0000         0
  360.0000         0    1.0000         0];

%Part Elim  for bend 1 and bend 2 on:
prt_elim_S = [       0  131.0000    0.9000    0.9000
         0   85.0000    0.0100    0.0100
         0   55.0000    0.0100    0.0100
         0   30.0000    0.0100    0.0100
         0   13.4000    0.0100    0.0100
         0    5.8800    0.0100    0.0100
         0         0    0.0100    0.0100
    4.5000  131.0000    0.4000    0.7000
    4.5000   85.0000    0.0100    0.0100
    4.5000   55.0000    0.0100    0.0100
    4.5000   30.0000    0.0100    0.0100
    4.5000   13.4000    0.0100    0.0100
    4.5000    5.8800    0.0100    0.0100
    4.5000         0    0.0100    0.0100
    9.0000  131.0000    0.0100    0.0100
    9.0000   85.0000    0.0100    0.0100
    9.0000   55.0000    0.0100    0.0100
    9.0000   30.0000    0.0100    0.0100
    9.0000   13.4000    0.0100    0.0100
    9.0000    5.8800    0.0100    0.0100
    9.0000         0    0.0100    0.0100
   13.5000  131.0000    0.0100    0.0100
   13.5000   85.0000    0.0100    0.0100
   13.5000   55.0000    0.0100    0.0100
   13.5000   40.0000    0.0100    0.0100
   13.5000   13.4000    0.0100    0.0100
   13.5000    5.8800    0.0100    0.0100
   13.5000         0    0.0100    0.0100
   18.0000  131.0000    0.0100    0.0100
   18.0000   85.0000    0.0100    0.0100
   18.0000   55.0000    0.0100    0.0100
   18.0000   30.0000    0.0100    0.0100
   18.0000   13.4000    0.0100    0.0100
   18.0000    5.8800    0.0100    0.0100
   18.0000         0    0.0100    0.0100
   22.5000  131.0000    0.0100    0.0100
   22.5000   85.0000    0.0100    0.0100
   22.5000   55.0000    0.0100    0.0100
   22.5000   30.0000    0.0100    0.0100
   22.5000   13.4000    0.0100    0.0100
   22.5000    5.8800    0.0100    0.0100
   22.5000         0    0.0100    0.0100
   27.0000  131.0000    0.0100    0.0100
   27.0000   85.0000    0.0100    0.0100
   27.0000   55.0000    0.0100    0.0100
   27.0000   40.0000    0.0100    0.6000
   27.0000   13.4000    0.0100    0.4000
   27.0000    5.8800    0.1000    0.4000
   27.0000         0    0.0100    0.0100
   31.5000  131.0000    0.0100    0.0100
   31.5000   85.0000    0.0100    0.0100
   31.5000   55.0000    0.0100    0.0100
   31.5000   30.0000    0.0100    0.8000
   31.5000   13.4000    0.0100    0.0100
   31.5000    5.8800    0.1000    0.4000
   31.5000         0    0.0100    0.0100
   36.0000  131.0000    0.9000    0.7000
   36.0000   85.0000    0.0100    0.0100
   36.0000   55.0000    0.0100    0.0100
   36.0000   30.0000    0.0100    0.6000
   36.0000   13.4000    0.8000    0.7000
   36.0000    5.8800    0.1000    0.9000
   36.0000         0    0.0100    0.0100
   40.5000  131.0000    0.8000    0.7000
   40.5000   85.0000    0.4000    0.7000
   40.5000   55.0000    0.2000    0.9000
   40.5000   40.0000    0.2000    0.9500
   40.5000   13.4000    0.8000    0.7000
   40.5000    5.8800    0.1000    0.6000
   40.5000         0    0.0100    0.0100
   45.0000  131.0000    0.6000    0.3000
   45.0000   85.0000    0.4000    0.7000
   45.0000   55.0000    0.6000    0.9000
   45.0000   30.0000    0.7000    0.9300
   45.0000   13.4000    0.8000    0.7000
   45.0000    5.8800    0.9000    0.8000
   45.0000         0    0.0100    0.7000
   49.5000  131.0000    0.2000    0.5000
   49.5000   85.0000    0.4000    0.7000
   49.5000   55.0000    0.5000    0.9000
   49.5000   30.0000    0.5000    0.9900
   49.5000   13.4000    0.5000    0.7500
   49.5000    5.8800    0.5800    0.7500
   49.5000         0    0.3500    0.6000
   54.0000  131.0000    0.2500    0.6700
   54.0000   85.0000    0.3400    0.8000
   54.0000   55.0000    0.3400    0.8000
   54.0000   30.0000    0.5300    0.9900
   54.0000   13.4000    0.5000    0.8000
   54.0000    5.8800    0.5800    0.9300
   54.0000         0    0.3500    0.6000
   58.5000  131.0000    0.2500    0.8000
   58.5000   85.0000    0.2300    0.8000
   58.5000   55.0000    0.5000    0.7000
   58.5000   30.0000    0.5300    0.9900
   58.5000   13.4000    0.4300    0.7500
   58.5000    5.8800    0.4500    0.7000
   58.5000         0    0.3000    0.6500
   63.0000  131.0000    0.2500    0.7000
   63.0000   85.0000    0.3600    0.7800
   63.0000   55.0000    0.4000    0.7000
   63.0000   30.0000    0.4600    0.9900
   63.0000   13.4000    0.3700    0.7000
   63.0000    5.8800    0.3000    0.5700
   63.0000         0    0.3000    0.5500
   67.5000  131.0000    0.2700    0.5500
   67.5000   85.0000    0.3600    0.8000
   67.5000   55.0000    0.3600    0.8000
   67.5000   30.0000    0.3800    0.8500
   67.5000   13.4000    0.3000    0.7600
   67.5000    5.8800    0.2200    0.5500
   67.5000         0    0.1900    0.4600
   72.0000  131.0000    0.2700    0.7000
   72.0000   85.0000    0.4500    0.8000
   72.0000   55.0000    0.3200    0.7000
   72.0000   30.0000    0.3200    0.7000
   72.0000   13.4000    0.2600    0.6000
   72.0000    5.8800    0.2000    0.4700
   72.0000         0    0.1500    0.4000
   76.5000  131.0000    0.2900    0.6500
   76.5000   85.0000    0.4500    0.7500
   76.5000   55.0000    0.3300    0.5800
   76.5000   30.0000    0.2600    0.5500
   76.5000   13.4000    0.2400    0.5500
   76.5000    5.8800    0.1800    0.4200
   76.5000         0    0.1500    0.3500
   81.0000  131.0000    0.3000    0.6500
   81.0000   85.0000    0.4300    0.7500
   81.0000   55.0000    0.3000    0.5500
   81.0000   30.0000    0.2100    0.4500
   81.0000   13.4000    0.2000    0.4000
   81.0000    5.8800    0.1700    0.3600
   81.0000         0    0.1500    0.2900
   85.5000  131.0000    0.3000    0.5500
   85.5000   85.0000    0.4500    0.7500
   85.5000   55.0000    0.3000    0.5500
   85.5000   30.0000    0.2400    0.4200
   85.5000   13.4000    0.1600    0.2500
   85.5000    5.8800    0.1200    0.2300
   85.5000         0    0.1200    0.2300
   90.0000  131.0000    0.3000    0.5000
   90.0000   85.0000    0.4300    0.7000
   90.0000   55.0000    0.3000    0.4500
   90.0000   30.0000    0.2000    0.4000
   90.0000   13.4000    0.1800    0.4100
   90.0000    5.8800    0.0800    0.1300
   90.0000         0    0.0800    0.0100
   96.0000  131.7647    0.3700    0.6600
   96.0000   84.4700    0.4300    0.7000
   96.0000   55.5000    0.2200    0.3800
   96.0000   30.8000    0.2000    0.0100
   96.0000   13.4000    0.1900    0.0100
   96.0000    5.8800    0.1724    0.0100
   96.0000         0    0.1300    0.0100
  108.0000  131.7647    0.3800    0.6900
  108.0000   84.4700    0.4200    0.7000
  108.0000   55.5000    0.2200    0.0100
  108.0000   30.8000    0.1800    0.0100
  108.0000   13.4000    0.1600    0.0100
  108.0000    5.8800    0.1400    0.0100
  108.0000         0    0.1200    0.0100
  120.0000  131.7647    0.4000    0.6900
  120.0000   84.4700    0.5000    0.7000
  120.0000   55.5000    0.2200    0.0100
  120.0000   30.8000    0.1900    0.0100
  120.0000   13.4000    0.1700    0.0100
  120.0000    5.8800    0.1400    0.0100
  120.0000         0    0.1250    0.0100
  132.0000  131.7647    0.5000    0.7000
  132.0000   84.4700    0.5000    0.7000
  132.0000   55.5000    0.2500    0.0100
  132.0000   30.8000    0.2200    0.0100
  132.0000   13.4000    0.1700    0.0100
  132.0000    5.8800    0.1500    0.0100
  132.0000         0    0.1398    0.0100
  144.0000  131.7647    0.3600    0.6500
  144.0000   84.4700    0.5100    0.7000
  144.0000   55.5000    0.2800    0.0100
  144.0000   30.8000    0.2471    0.0100
  144.0000   13.4000    0.1800    0.0100
  144.0000    5.8800    0.1758    0.0100
  144.0000         0    0.1398    0.0100
  156.0000  131.7647    0.4000    0.7000
  156.0000   84.4700    0.5100    0.7000
  156.0000   55.5000    0.3100    0.0100
  156.0000   30.8000    0.2471    0.0100
  156.0000   13.4000    0.2000    0.0100
  156.0000    5.8800    0.1500    0.0100
  156.0000         0    0.1500    0.0100
  168.0000  131.7647    0.4000    0.7000
  168.0000   84.4700    0.5200    0.7000
  168.0000   55.5000    0.3600    0.4000
  168.0000   30.8000    0.2564    0.0100
  168.0000   13.4000    0.2099    0.0100
  168.0000    5.8800    0.1900    0.0100
  168.0000         0    0.1900    0.0100
  180.0000  131.7647    0.4000    0.6500
  180.0000   84.4700    0.5500    0.7000
  180.0000   55.5000    0.3400    0.4000
  180.0000   30.8000    0.3056    0.0100
  180.0000   13.4000    0.2600    0.0100
  180.0000    5.8800    0.2300    0.0100
  180.0000         0    0.2300    0.0100
  192.0000  131.7647    0.3500    0.5600
  192.0000   84.4700    0.5300    0.7000
  192.0000   55.5000    0.3200    0.3000
  192.0000   30.8000    0.2857    0.0100
  192.0000   13.4000    0.2700    0.0100
  192.0000    5.8800    0.2700    0.0100
  192.0000         0    0.2700    0.0100
  204.0000  131.7647    0.4000    0.7000
  204.0000   84.4700    0.5300    0.8000
  204.0000   55.5000    0.4300    0.4000
  204.0000   30.8000    0.4000    0.4000
  204.0000   13.4000    0.3000    0.3000
  204.0000    5.8800    0.2800    0.3000
  204.0000         0    0.3000    0.0100
  216.0000  131.7647    0.4000    0.7000
  216.0000   84.4700    0.5000    0.6000
  216.0000   55.5000    0.4300    0.4500
  216.0000   30.8000    0.2857    0.2800
  216.0000   13.4000    0.3000    0.3200
  216.0000    5.8800    0.2800    0.2500
  216.0000         0    0.2800    0.0100
  228.0000  131.7647    0.4000    0.8500
  228.0000   84.4700    0.4000    0.3000
  228.0000   55.5000    0.4000    0.6000
  228.0000   30.8000    0.3000    0.2100
  228.0000   13.4000    0.3000    0.2600
  228.0000    5.8800    0.3200    0.3000
  228.0000         0    0.2800    0.0010
  240.0000  131.7647    0.4000    0.9000
  240.0000   84.4700    0.4000    0.5000
  240.0000   55.5000    0.4200    0.3800
  240.0000   30.8000    0.3208    0.2100
  240.0000   13.4000    0.3000    0.2500
  240.0000    5.8800    0.3200    0.2500
  240.0000         0    0.3000    0.1700
  252.0000  131.7647    0.3000    0.0932
  252.0000   84.4700    0.4107    0.4000
  252.0000   55.5000    0.4500    0.5000
  252.0000   30.8000    0.3617    0.2800
  252.0000   13.4000    0.3000    0.3000
  252.0000    5.8800    0.3000    0.3000
  252.0000         0    0.2900    0.0100
  264.0000  131.7647    0.3000    0.0100
  264.0000   84.4700    0.3000    0.4000
  264.0000   55.5000    0.5000    0.5000
  264.0000   30.8000    0.4000    0.4000
  264.0000   13.4000    0.3400    0.4800
  264.0000    5.8800    0.3000    0.4800
  264.0000         0    0.2600    0.0010
  276.0000  131.7647    0.0100    0.0100
  276.0000   84.4700    0.3000    0.7000
  276.0000   55.5000    0.9000    0.4000
  276.0000   30.8000    0.5000    0.4500
  276.0000   13.4000    0.4118    0.6000
  276.0000    5.8800    0.4500    0.9000
  276.0000         0    0.3300    0.1500
  288.0000  131.7647    0.0100    0.0100
  288.0000   84.4700    0.3000    0.6000
  288.0000   55.5000    0.7000    0.7000
  288.0000   30.8000    0.9821    0.6000
  288.0000   13.4000    0.7241    0.6000
  288.0000    5.8800    0.5000    0.9900
  288.0000         0    0.5000    0.4500
  300.0000  131.7647    0.0100    0.0100
  300.0000   84.4700    0.3000    0.5000
  300.0000   55.5000    0.7000    0.7000
  300.0000   30.8000    0.9900    0.7000
  300.0000   13.4000    0.9000    0.9000
  300.0000    5.8800    0.9000    0.9000
  300.0000         0    0.0100    0.0100
  312.0000  131.7647    0.0100    0.0100
  312.0000   84.4700    0.3000    0.5000
  312.0000   55.5000    0.0100    0.0100
  312.0000   30.8000    0.0100    0.0100
  312.0000   13.4000    0.0100    0.0100
  312.0000    5.8800    0.0100    0.0100
  312.0000         0    0.0100    0.0100
  324.0000  131.7647    0.0100    0.0100
  324.0000   84.4700    0.3000    0.5000
  324.0000   55.5000    0.0100    0.0100
  324.0000   30.8000    0.0100    0.0100
  324.0000   13.4000    0.0100    0.0100
  324.0000    5.8800    0.0100    0.0100
  324.0000         0    0.0100    0.0100
  336.0000  131.7647    0.0100    0.0100
  336.0000   84.4700    0.0100    0.0100
  336.0000   55.5000    0.0100    0.0100
  336.0000   30.8000    0.0100    0.0100
  336.0000   13.4000    0.0100    0.0100
  336.0000    5.8800    0.0100    0.0100
  336.0000         0    0.0100    0.0100
  348.0000  131.7647    0.0100    0.0100
  348.0000   84.4700    0.0100    0.0100
  348.0000   55.5000    0.0100    0.0100
  348.0000   30.8000    0.0100    0.0100
  348.0000   13.4000    0.0100    0.0100
  348.0000    5.8800    0.0100    0.0100
  348.0000         0    0.0100    0.0100
  360.0000  131.7647    0.0100    0.0100
  360.0000   84.4700    0.0100    0.0100
  360.0000   55.5000    0.0100    0.0100
  360.0000   30.8000    0.0100    0.0100
  360.0000   13.4000    0.0100    0.0100
  360.0000    5.8800    0.0100    0.0100
  360.0000         0    0.0100    0.0100];

% I where facil switches to block (per S)
I_switch_facils = [  30    32    35    35    35    50    50];
%PR where bend occurs per S
pr_bend_per_S = [140   100    70    50    32    20     0];

end